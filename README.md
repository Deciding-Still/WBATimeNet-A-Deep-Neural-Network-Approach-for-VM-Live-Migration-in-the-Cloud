# WBATimeNet-A-Deep-Neural-Network-Approach-for-VM-Live-Migration-in-the-Cloud

## Project Overview

WBATimeNet is a deep learning model designed to predict the optimal migration time and feasibility for virtual machines (VMs) in cloud environments. This model leverages a combination of Convolutional Neural Networks (CNNs) and Long Short-Term Memory (LSTM) networks to dynamically assess VM resource usage patterns, improving cloud resource allocation and reducing performance impacts due to inefficient migrations.

## Table of Contents
- [Project Overview](#project-overview)
- [Features](#features)
- [Architecture](#architecture)
- [Installation](#installation)
- [Usage](#usage)
- [Dataset](#dataset)
- [Model Training](#model-training)
- [Evaluation](#evaluation)
- [Results](#results)
- [Contributors](#contributors)
- [License](#license)

## Features

- **Dual Output Prediction**: Predicts migration feasibility ("Go"/"No-go") and optimal migration time.
- **CNN-LSTM Hybrid Architecture**: Captures both short-term and long-term usage patterns.
- **Adversarial Training**: Enhances robustness by training on both regular and adversarial examples.
- **Adaptive Migration Strategy**: Avoids fixed thresholds, allowing decisions to adapt based on usage patterns.

## Architecture

### LSTM Unit

The LSTM unit captures long-term dependencies in VM resource usage, helping the model retain important past information while filtering out irrelevant data through its forget, input, and output gates.

![LSTM Unit Architecture](https://github.com/Deciding-Still/WBATimeNet-A-Deep-Neural-Network-Approach-for-VM-Live-Migration-in-the-Cloud/blob/main/LSTM.png)

### WBATimeNet Model

The WBATimeNet model combines CNN, LSTM, and adversarial training techniques. Adversarial examples help the model remain robust under challenging usage patterns. The model loss is a combination of the main and adversarial losses, which enhances its predictive accuracy and resilience.

![WBATimeNet Architecture](https://github.com/Deciding-Still/WBATimeNet-A-Deep-Neural-Network-Approach-for-VM-Live-Migration-in-the-Cloud/blob/main/WBATimeNet.png)

## Installation

1. **Clone the Repository**
   ```bash
   git clone https://github.com/your-username/WBATimeNet.git
   cd WBATimeNet
   ```

2. **Install Dependencies**
   - Create a virtual environment (optional but recommended).
   ```bash
   python -m venv venv
   source venv/bin/activate  # On Windows, use `venv\Scripts\activate`
   ```
   - Install required packages.
   ```bash
   pip install -r requirements.txt
   ```

## Usage

1. **Prepare Data**: Ensure that your dataset of VM usage metrics (CPU, memory, disk read/write) is formatted correctly. Use the sample data format provided in the `data/` folder.

2. **Run Training**:
   ```bash
   python train.py
   ```
   This will train the WBATimeNet model and save it to the specified directory.

3. **Run Evaluation**:
   ```bash
   python evaluate.py
   ```
   Evaluate the model on test data to check its performance in predicting VM migration times and feasibility.

## Dataset

The dataset should contain time-series metrics of VM resource usage, such as CPU, memory, disk-read, and disk-write rates. A sample dataset structure is provided in the `data/` folder.

- **Input Format**: Each VM’s metrics over a fixed period (e.g., 7 days with 1-hour intervals).
- **Output Labels**: Binary values for migration feasibility and continuous values for migration time.

## Model Training

The model uses both standard and adversarial training:
- **Main Loss**: Based on predictions with standard inputs.
- **Adversarial Loss**: Generated by introducing perturbations, improving the model’s robustness.

Run the training script to train WBATimeNet, specifying parameters like batch size, learning rate, and epochs in `config.yaml`.

## Evaluation

Evaluate the model on test data to check:
- **Accuracy of Migration Feasibility Predictions**
- **Precision of Optimal Migration Times**

Use the provided `evaluate.py` script to automate evaluation and view performance metrics.

## Results

Expected results:
- **High accuracy in identifying suitable times for VM migration ("Go"/"No-go")**.
- **Accurate prediction of the optimal hour for migration** within the 24-hour period.

## Contributors

- **Vikas Kushwaha**
- **Hitha N** 

## License

This project is licensed under the MIT License. See the `LICENSE` file for details.
